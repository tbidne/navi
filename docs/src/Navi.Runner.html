<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-unused-imports #-}</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Navi.Runner.html"><span class="hs-identifier">Navi.Runner</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Navi.Runner.html#makeEnvAndRun"><span class="hs-identifier">makeEnvAndRun</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Navi.Runner.html#withEnv"><span class="hs-identifier">withEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.html"><span class="hs-identifier">Data.Bytes</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bytes</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Formatting.html"><span class="hs-identifier">Data.Bytes.Formatting</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Formatting.Base.html#FloatingFormatter"><span class="hs-identifier">FloatingFormatter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Formatting.Base.html#MkFloatingFormatter"><span class="hs-identifier">MkFloatingFormatter</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Identity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runIdentity</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html"><span class="hs-identifier">Effects.FileSystem.HandleWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier">MonadHandleWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#withBinaryFile"><span class="hs-identifier">withBinaryFile</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#die"><span class="hs-identifier">die</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html"><span class="hs-identifier">Effects.FileSystem.PathReader</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Dir</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html"><span class="hs-identifier">Effects.FileSystem.PathWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier">MonadPathWriter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html"><span class="hs-identifier">Effects.FileSystem.PathWriter</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Dir</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html"><span class="hs-identifier">Effects.Time</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html#MonadTime"><span class="hs-identifier">MonadTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html"><span class="hs-identifier">Effects.Time</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Time</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/fs-utils-0.1-797e36c7cf412445c50285f8d3e59bbabbc28585c046e40b74676c1091471c31/share/doc/html/src/FileSystem.OsPath.html"><span class="hs-identifier">FileSystem.OsPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/fs-utils-0.1-797e36c7cf412445c50285f8d3e59bbabbc28585c046e40b74676c1091471c31/share/doc/html/src/FileSystem.OsPath.html#encodeThrowM"><span class="hs-identifier">encodeThrowM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/fs-utils-0.1-797e36c7cf412445c50285f8d3e59bbabbc28585c046e40b74676c1091471c31/share/doc/html/src/FileSystem.OsPath.html#encodeValidThrowM"><span class="hs-identifier">encodeValidThrowM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Conc.Sync</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">setUncaughtExceptionHandler</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.html"><span class="hs-identifier">Navi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.NaviT.html#NaviT"><span class="hs-identifier">NaviT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.html#runNavi"><span class="hs-identifier">runNavi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.NaviT.html#runNaviT"><span class="hs-identifier">runNaviT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Args.html"><span class="hs-identifier">Navi.Args</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Args.html#Args"><span class="hs-identifier">Args</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.Args.html#getArgs"><span class="hs-identifier">getArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Config.html"><span class="hs-identifier">Navi.Config</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#Config"><span class="hs-identifier">Config</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#LogLoc"><span class="hs-identifier">LogLoc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Config.Types.html#DefPath"><span class="hs-identifier">DefPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#File"><span class="hs-identifier">File</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#Stdout"><span class="hs-identifier">Stdout</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#Logging"><span class="hs-identifier">Logging</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#NoteSystem"><span class="hs-identifier">NoteSystem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Config.Types.html#AppleScript"><span class="hs-identifier">AppleScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#DBus"><span class="hs-identifier">DBus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#NotifySend"><span class="hs-identifier">NotifySend</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Navi.Config.html#readConfig"><span class="hs-identifier">readConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Config.Types.html"><span class="hs-identifier">Navi.Config.Types</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#FilesSizeMode"><span class="hs-identifier">FilesSizeMode</span></a></span><span>
</span><span id="line-35"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#FilesSizeModeDelete"><span class="hs-identifier">FilesSizeModeDelete</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="Navi.Config.Types.html#FilesSizeModeWarn"><span class="hs-identifier">FilesSizeModeWarn</span></a></span><span>
</span><span id="line-37"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#defaultSizeMode"><span class="hs-identifier">defaultSizeMode</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Data.NaviLog.html"><span class="hs-identifier">Navi.Data.NaviLog</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Navi.Data.NaviLog.html#LogEnv"><span class="hs-identifier">LogEnv</span></a></span><span>
</span><span id="line-42"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Navi.Data.NaviLog.html#MkLogEnv"><span class="hs-identifier">MkLogEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="Navi.Data.NaviLog.html#logHandle"><span class="hs-identifier">logHandle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><a href="Navi.Data.NaviLog.html#logLevel"><span class="hs-identifier">logLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><a href="Navi.Data.NaviLog.html#logNamespace"><span class="hs-identifier">logNamespace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="Navi.Data.NaviLog.html#logQueue"><span class="hs-identifier">logQueue</span></a></span><span>
</span><span id="line-47"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Effects.html"><span class="hs-identifier">Navi.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Effects.MonadSystemInfo.html#MonadSystemInfo"><span class="hs-identifier">MonadSystemInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Effects.MonadNotify.html"><span class="hs-identifier">Navi.Effects.MonadNotify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Effects.MonadNotify.html#MonadNotify"><span class="hs-identifier">MonadNotify</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Env.AppleScript.html"><span class="hs-identifier">Navi.Env.AppleScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Env.AppleScript.html#mkAppleScriptEnv"><span class="hs-identifier">mkAppleScriptEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Env.Core.html"><span class="hs-identifier">Navi.Env.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Env.Core.html#Env"><span class="hs-identifier">Env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Env.DBus.html"><span class="hs-identifier">Navi.Env.DBus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Env.DBus.html#MonadDBus"><span class="hs-identifier">MonadDBus</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Navi.Env.DBus.html#mkDBusEnv"><span class="hs-identifier">mkDBusEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Env.NotifySend.html"><span class="hs-identifier">Navi.Env.NotifySend</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Env.NotifySend.html#mkNotifySendEnv"><span class="hs-identifier">mkNotifySendEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Navi.Prelude.html"><span class="hs-identifier">Navi.Prelude</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">{- ORMOLU_DISABLE -}</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Navi.Runner.html#makeEnvAndRun"><span class="hs-identifier hs-type">makeEnvAndRun</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679451380"><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-async-0.1-92505361e9389c19c3a5d53a84746fea7444a136440f9d5dc875dfd7fe4e81c0/share/doc/html/src/Effects.Concurrent.Async.html#MonadAsync"><span class="hs-identifier hs-type">MonadAsync</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><a href="Navi.Env.DBus.html#MonadDBus"><span class="hs-identifier hs-type">MonadDBus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileReader.html#MonadFileReader"><span class="hs-identifier hs-type">MonadFileReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileWriter.html#MonadFileWriter"><span class="hs-identifier hs-type">MonadFileWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-ioref-0.1-25c95ecfb75289adf8e828362701d2f37c9416a7dcb79ab845a0ea3f271c8e04/share/doc/html/src/Effects.IORef.html#MonadIORef"><span class="hs-identifier hs-type">MonadIORef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-optparse-0.1-54d7e989620d13d99828e25212af11878db4908c096c46d043459b7c4caddc9e/share/doc/html/src/Effects.Optparse.html#MonadOptparse"><span class="hs-identifier hs-type">MonadOptparse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-stm-0.1-40899f55d48f65db7cb4133b939db8d91dc3f278e6eb5e4e974f6a0dace8862a/share/doc/html/src/Effects.Concurrent.STM.html#MonadSTM"><span class="hs-identifier hs-type">MonadSTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Navi.Effects.MonadSystemInfo.html#MonadSystemInfo"><span class="hs-identifier hs-type">MonadSystemInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-thread-0.1-984337e11e74caefb237fc99375eac74d438a0df24f81d572c72963188ec227c/share/doc/html/src/Effects.Concurrent.Thread.html#MonadThread"><span class="hs-identifier hs-type">MonadThread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html#MonadTime"><span class="hs-identifier hs-type">MonadTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-typed-process-0.1-8888432432a71c579e54c55b0263a4cf87cdd28103b8e9a3fcbfd00effd4fb7a/share/doc/html/src/Effects.Process.Typed.html#MonadTypedProcess"><span class="hs-identifier hs-type">MonadTypedProcess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="#local-6989586621679451380"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span id="makeEnvAndRun"><span class="annot"><span class="annottext">makeEnvAndRun :: forall (m :: Type -&gt; Type).
(HasCallStack, MonadAsync m, MonadDBus m, MonadFileReader m,
 MonadFileWriter m, MonadHandleWriter m, MonadIORef m, MonadMask m,
 MonadOptparse m, MonadPathReader m, MonadPathWriter m, MonadSTM m,
 MonadSystemInfo m, MonadTerminal m, MonadThread m, MonadTime m,
 MonadTypedProcess m) =&gt;
m ()
</span><a href="Navi.Runner.html#makeEnvAndRun"><span class="hs-identifier hs-var hs-var">makeEnvAndRun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Env -&gt; m ()) -&gt; m ()
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadAsync m, MonadDBus m, MonadFileReader m,
 MonadFileWriter m, MonadHandleWriter m, MonadIORef m, MonadMask m,
 MonadOptparse m, MonadPathReader m, MonadPathWriter m, MonadSTM m,
 MonadTerminal m, MonadTime m) =&gt;
(Env -&gt; m a) -&gt; m a
</span><a href="Navi.Runner.html#withEnv"><span class="hs-identifier hs-var">withEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Env -&gt; m ()
forall {k} {env} {f :: Type -&gt; Type} {b}.
(LabelOptic' &quot;namespace&quot; k env Namespace, Is k A_Setter,
 Is k A_Getter, MonadIORef f, MonadHandleWriter f, MonadAsync f,
 HasNoteQueue env, HasLogEnv env, HasEvents env,
 MonadLogger (NaviT env f), MonadMask f, MonadNotify (NaviT env f),
 MonadSTM f, MonadSystemInfo f, MonadTerminal f, MonadThread f) =&gt;
env -&gt; f b
</span><a href="#local-6989586621679451749"><span class="hs-identifier hs-var">runWithEnv</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679451749"><span class="annot"><span class="annottext">runWithEnv :: env -&gt; f b
</span><a href="#local-6989586621679451749"><span class="hs-identifier hs-var hs-var">runWithEnv</span></a></span></span><span> </span><span id="local-6989586621679451853"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621679451853"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Void -&gt; b
forall a. Void -&gt; a
</span><span class="hs-identifier hs-var">absurd</span></span><span> </span><span class="annot"><span class="annottext">(Void -&gt; b) -&gt; f Void -&gt; f b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NaviT env f Void -&gt; env -&gt; f Void
forall env (m :: Type -&gt; Type) a. NaviT env m a -&gt; env -&gt; m a
</span><a href="Navi.NaviT.html#runNaviT"><span class="hs-identifier hs-var">runNaviT</span></a></span><span> </span><span class="annot"><span class="annottext">NaviT env f Void
forall env (m :: Type -&gt; Type) k.
(HasCallStack, HasEvents env, HasLogEnv env, HasNoteQueue env,
 MonadAsync m, MonadHandleWriter m, MonadIORef m,
 MonadLoggerNS m env k, MonadMask m, MonadNotify m, MonadSTM m,
 MonadSystemInfo m, MonadTerminal m, MonadThread m) =&gt;
m Void
</span><a href="Navi.html#runNavi"><span class="hs-identifier hs-var">runNavi</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621679451853"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="Navi.Runner.html#withEnv"><span class="hs-identifier hs-type">withEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679451420"><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679451421"><span class="annot"><a href="#local-6989586621679451421"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-async-0.1-92505361e9389c19c3a5d53a84746fea7444a136440f9d5dc875dfd7fe4e81c0/share/doc/html/src/Effects.Concurrent.Async.html#MonadAsync"><span class="hs-identifier hs-type">MonadAsync</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Navi.Env.DBus.html#MonadDBus"><span class="hs-identifier hs-type">MonadDBus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileReader.html#MonadFileReader"><span class="hs-identifier hs-type">MonadFileReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileWriter.html#MonadFileWriter"><span class="hs-identifier hs-type">MonadFileWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-ioref-0.1-25c95ecfb75289adf8e828362701d2f37c9416a7dcb79ab845a0ea3f271c8e04/share/doc/html/src/Effects.IORef.html#MonadIORef"><span class="hs-identifier hs-type">MonadIORef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadMask</span></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-optparse-0.1-54d7e989620d13d99828e25212af11878db4908c096c46d043459b7c4caddc9e/share/doc/html/src/Effects.Optparse.html#MonadOptparse"><span class="hs-identifier hs-type">MonadOptparse</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-stm-0.1-40899f55d48f65db7cb4133b939db8d91dc3f278e6eb5e4e974f6a0dace8862a/share/doc/html/src/Effects.Concurrent.STM.html#MonadSTM"><span class="hs-identifier hs-type">MonadSTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html#MonadTime"><span class="hs-identifier hs-type">MonadTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Navi.Env.Core.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451421"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451421"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-103"></span><span id="withEnv"><span class="annot"><span class="annottext">withEnv :: forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadAsync m, MonadDBus m, MonadFileReader m,
 MonadFileWriter m, MonadHandleWriter m, MonadIORef m, MonadMask m,
 MonadOptparse m, MonadPathReader m, MonadPathWriter m, MonadSTM m,
 MonadTerminal m, MonadTime m) =&gt;
(Env -&gt; m a) -&gt; m a
</span><a href="Navi.Runner.html#withEnv"><span class="hs-identifier hs-var hs-var">withEnv</span></a></span></span><span> </span><span id="local-6989586621679451933"><span class="annot"><span class="annottext">Env -&gt; m a
</span><a href="#local-6989586621679451933"><span class="hs-identifier hs-var">onEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679451934"><span class="annot"><span class="annottext">Args Identity
</span><a href="#local-6989586621679451934"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Args Identity)
forall (m :: Type -&gt; Type).
(HasCallStack, MonadOptparse m, MonadPathReader m) =&gt;
m (Args Identity)
</span><a href="Navi.Args.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679451935"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679451935"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">Args Identity -&gt; m Config
forall (m :: Type -&gt; Type).
(HasCallStack, MonadFileReader m, MonadIORef m, MonadThrow m) =&gt;
Args Identity -&gt; m Config
</span><a href="Navi.Runner.html#tryParseConfig"><span class="hs-identifier hs-var">tryParseConfig</span></a></span><span> </span><span class="annot"><span class="annottext">Args Identity
</span><a href="#local-6989586621679451934"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">m Config -&gt; (SomeException -&gt; m Config) -&gt; m Config
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadCatch m) =&gt;
m a -&gt; (SomeException -&gt; m a) -&gt; m a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/exception-utils-0.1-1728acbab622bcd9468979fe1d8c02c1c03a1513a46b35cc599c4d2e06790039/share/doc/html/src/Control.Exception.Utils.html#catchSync"><span class="hs-operator hs-var">`catchSync`</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; m Config
forall (m :: Type -&gt; Type) void.
(HasCallStack, MonadFileWriter m, MonadHandleWriter m,
 MonadPathReader m, MonadPathWriter m, MonadThrow m) =&gt;
SomeException -&gt; m void
</span><a href="Navi.Runner.html#writeConfigErr"><span class="hs-identifier hs-var">writeConfigErr</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="annottext">Logging -&gt; (Maybe LogEnv -&gt; m a) -&gt; m a
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadSTM m, MonadTerminal m, MonadThrow m,
 MonadTime m) =&gt;
Logging -&gt; (Maybe LogEnv -&gt; m a) -&gt; m a
</span><a href="Navi.Runner.html#withLogEnv"><span class="hs-identifier hs-var">withLogEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679451935"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Config -&gt; Optic' A_Lens NoIx Config Logging -&gt; Logging
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/p6bvlvr5rdvj4y8b69w8rqyly64c6n1d-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx Config Logging
</span><span class="">#logging</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Maybe LogEnv -&gt; m a) -&gt; m a) -&gt; (Maybe LogEnv -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679451941"><span class="annot"><span class="annottext">Maybe LogEnv
</span><a href="#local-6989586621679451941"><span class="hs-identifier hs-var">logEnv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451520"><span class="annot"><a href="#local-6989586621679451942"><span class="hs-identifier hs-type">mkNaviEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Navi.Data.NaviLog.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Navi.Config.Types.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451420"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451520"><span class="hs-identifier hs-type">env</span></a></span></span><span>
</span><span id="line-111"></span><span>        </span><span id="local-6989586621679451942"><span class="annot"><span class="annottext">mkNaviEnv :: forall env. (Maybe LogEnv -&gt; Config -&gt; m env) -&gt; m env
</span><a href="#local-6989586621679451942"><span class="hs-identifier hs-var hs-var">mkNaviEnv</span></a></span></span><span> </span><span id="local-6989586621679451943"><span class="annot"><span class="annottext">Maybe LogEnv -&gt; Config -&gt; m env
</span><a href="#local-6989586621679451943"><span class="hs-identifier hs-var">envFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe LogEnv -&gt; Config -&gt; m env
</span><a href="#local-6989586621679451943"><span class="hs-identifier hs-var">envFn</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe LogEnv
</span><a href="#local-6989586621679451941"><span class="hs-identifier hs-var">logEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679451935"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679451935"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Config
-&gt; Optic' A_Lens NoIx Config (NoteSystem 'ConfigPhaseToml)
-&gt; NoteSystem 'ConfigPhaseToml
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/p6bvlvr5rdvj4y8b69w8rqyly64c6n1d-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx Config (NoteSystem 'ConfigPhaseToml)
</span><span class="">#noteSystem</span></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if OSX
</span><span>      </span><span class="hs-identifier">AppleScript</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">mkNaviEnv</span><span> </span><span class="hs-identifier">mkAppleScriptEnv</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">onEnv</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-identifier">DBus</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">throwText</span><span> </span><span class="hs-string">&quot;Detected osx, but DBus is only available on linux!&quot;</span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-identifier">NotifySend</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">throwText</span><span> </span><span class="hs-string">&quot;Detected osx, but NotifySend is only available on linux!&quot;</span><span class="hs-cpp">
#else
</span><span>      </span><span class="annot"><span class="annottext">NoteSystem 'ConfigPhaseToml
</span><a href="Navi.Config.Types.html#AppleScript"><span class="hs-identifier hs-var">AppleScript</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; m a
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadThrow m) =&gt;
Text -&gt; m a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/exception-utils-0.1-1728acbab622bcd9468979fe1d8c02c1c03a1513a46b35cc599c4d2e06790039/share/doc/html/src/Control.Exception.Utils.html#throwText"><span class="hs-identifier hs-var">throwText</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Detected linux, but AppleScript is only available on osx!&quot;</span></span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><a href="Navi.Config.Types.html#DBus"><span class="hs-identifier hs-type">DBus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe LogEnv -&gt; Config -&gt; m Env) -&gt; m Env
forall env. (Maybe LogEnv -&gt; Config -&gt; m env) -&gt; m env
</span><a href="#local-6989586621679451942"><span class="hs-identifier hs-var">mkNaviEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe LogEnv -&gt; Config -&gt; m Env
forall (m :: Type -&gt; Type).
(HasCallStack, MonadDBus m, MonadSTM m) =&gt;
Maybe LogEnv -&gt; Config -&gt; m Env
</span><a href="Navi.Env.DBus.html#mkDBusEnv"><span class="hs-identifier hs-var">mkDBusEnv</span></a></span><span> </span><span class="annot"><span class="annottext">m Env -&gt; (Env -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; m a
</span><a href="#local-6989586621679451933"><span class="hs-identifier hs-var">onEnv</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><span class="annottext">NoteSystem 'ConfigPhaseToml
</span><a href="Navi.Config.Types.html#NotifySend"><span class="hs-identifier hs-var">NotifySend</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe LogEnv -&gt; Config -&gt; m Env) -&gt; m Env
forall env. (Maybe LogEnv -&gt; Config -&gt; m env) -&gt; m env
</span><a href="#local-6989586621679451942"><span class="hs-identifier hs-var">mkNaviEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe LogEnv -&gt; Config -&gt; m Env
forall (m :: Type -&gt; Type).
MonadSTM m =&gt;
Maybe LogEnv -&gt; Config -&gt; m Env
</span><a href="Navi.Env.NotifySend.html#mkNotifySendEnv"><span class="hs-identifier hs-var">mkNotifySendEnv</span></a></span><span> </span><span class="annot"><span class="annottext">m Env -&gt; (Env -&gt; m a) -&gt; m a
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Env -&gt; m a
</span><a href="#local-6989586621679451933"><span class="hs-identifier hs-var">onEnv</span></a></span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-comment">--where</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">--  runWithEnv env = absurd &lt;$&gt; runNaviT runNavi env</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">{- ORMOLU_ENABLE -}</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span id="local-6989586621679451503"><span class="annot"><a href="Navi.Runner.html#tryParseConfig"><span class="hs-identifier hs-type">tryParseConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileReader.html#MonadFileReader"><span class="hs-identifier hs-type">MonadFileReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451503"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-ioref-0.1-25c95ecfb75289adf8e828362701d2f37c9416a7dcb79ab845a0ea3f271c8e04/share/doc/html/src/Effects.IORef.html#MonadIORef"><span class="hs-identifier hs-type">MonadIORef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451503"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679451503"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><a href="Navi.Args.html#Args"><span class="hs-identifier hs-type">Args</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="#local-6989586621679451503"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Navi.Config.Types.html#Config"><span class="hs-identifier hs-type">Config</span></a></span></span><span>
</span><span id="line-135"></span><span id="tryParseConfig"><span class="annot"><span class="annottext">tryParseConfig :: forall (m :: Type -&gt; Type).
(HasCallStack, MonadFileReader m, MonadIORef m, MonadThrow m) =&gt;
Args Identity -&gt; m Config
</span><a href="Navi.Runner.html#tryParseConfig"><span class="hs-identifier hs-var hs-var">tryParseConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="annottext">OsPath -&gt; m Config
forall (m :: Type -&gt; Type).
(HasCallStack, MonadFileReader m, MonadIORef m, MonadThrow m) =&gt;
OsPath -&gt; m Config
</span><a href="Navi.Config.html#readConfig"><span class="hs-identifier hs-var">readConfig</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="annottext">(OsPath -&gt; m Config)
-&gt; (Args Identity -&gt; OsPath) -&gt; Args Identity -&gt; m Config
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; Type) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Identity OsPath -&gt; OsPath
forall a. Identity a -&gt; a
</span><span class="hs-identifier hs-var">runIdentity</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="annottext">(Identity OsPath -&gt; OsPath)
-&gt; (Args Identity -&gt; Identity OsPath) -&gt; Args Identity -&gt; OsPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; Type) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Optic' An_Iso NoIx (Args Identity) (Identity OsPath)
-&gt; Args Identity -&gt; Identity OsPath
forall k (is :: IxList) s a.
Is k A_Getter =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><a href="file:///nix/store/p6bvlvr5rdvj4y8b69w8rqyly64c6n1d-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Getter.html#view"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' An_Iso NoIx (Args Identity) (Identity OsPath)
</span><span class="">#configFile</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679451510"><span id="local-6989586621679451511"><span class="annot"><a href="Navi.Runner.html#withLogEnv"><span class="hs-identifier hs-type">withLogEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-stm-0.1-40899f55d48f65db7cb4133b939db8d91dc3f278e6eb5e4e974f6a0dace8862a/share/doc/html/src/Effects.Concurrent.STM.html#MonadSTM"><span class="hs-identifier hs-type">MonadSTM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html#MonadTime"><span class="hs-identifier hs-type">MonadTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Navi.Config.Types.html#Logging"><span class="hs-identifier hs-type">Logging</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Navi.Data.NaviLog.html#LogEnv"><span class="hs-identifier hs-type">LogEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451511"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>  </span><span class="annot"><a href="#local-6989586621679451510"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451511"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-153"></span><span id="withLogEnv"><span class="annot"><span class="annottext">withLogEnv :: forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadSTM m, MonadTerminal m, MonadThrow m,
 MonadTime m) =&gt;
Logging -&gt; (Maybe LogEnv -&gt; m a) -&gt; m a
</span><a href="Navi.Runner.html#withLogEnv"><span class="hs-identifier hs-var hs-var">withLogEnv</span></a></span></span><span> </span><span id="local-6989586621679452002"><span class="annot"><span class="annottext">Logging
</span><a href="#local-6989586621679452002"><span class="hs-identifier hs-var">logging</span></a></span></span><span> </span><span id="local-6989586621679452003"><span class="annot"><span class="annottext">Maybe LogEnv -&gt; m a
</span><a href="#local-6989586621679452003"><span class="hs-identifier hs-var">onLogEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Logging
</span><a href="#local-6989586621679452002"><span class="hs-identifier hs-var">logging</span></a></span><span> </span><span class="annot"><span class="annottext">Logging
-&gt; Optic' A_Lens NoIx Logging (Maybe LogLevel) -&gt; Maybe LogLevel
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/p6bvlvr5rdvj4y8b69w8rqyly64c6n1d-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx Logging (Maybe LogLevel)
</span><span class="">#severity</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">Maybe LogLevel
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe LogEnv -&gt; m a
</span><a href="#local-6989586621679452003"><span class="hs-identifier hs-var">onLogEnv</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe LogEnv
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679452004"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679452004"><span class="hs-identifier hs-var">logLevel</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-157"></span><span>      </span><span id="local-6989586621679452005"><span class="annot"><span class="annottext">TBQueue LogStr
</span><a href="#local-6989586621679452005"><span class="hs-identifier hs-var">logQueue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; m (TBQueue LogStr)
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadSTM m) =&gt;
Natural -&gt; m (TBQueue a)
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-stm-0.1-40899f55d48f65db7cb4133b939db8d91dc3f278e6eb5e4e974f6a0dace8862a/share/doc/html/src/Effects.Concurrent.STM.html#newTBQueueA"><span class="hs-identifier hs-var">newTBQueueA</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">1000</span></span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">Logging -&gt; (Maybe Handle -&gt; m a) -&gt; m a
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadTerminal m, MonadThrow m, MonadTime m) =&gt;
Logging -&gt; (Maybe Handle -&gt; m a) -&gt; m a
</span><a href="Navi.Runner.html#withLogHandle"><span class="hs-identifier hs-var">withLogHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Logging
</span><a href="#local-6989586621679452002"><span class="hs-identifier hs-var">logging</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Handle -&gt; m a) -&gt; m a) -&gt; (Maybe Handle -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679452008"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679452008"><span class="hs-identifier hs-var">logHandle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">Maybe LogEnv -&gt; m a
</span><a href="#local-6989586621679452003"><span class="hs-identifier hs-var">onLogEnv</span></a></span><span>
</span><span id="line-160"></span><span>          </span><span class="annot"><span class="annottext">(Maybe LogEnv -&gt; m a) -&gt; Maybe LogEnv -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LogEnv -&gt; Maybe LogEnv
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-161"></span><span>          </span><span class="annot"><span class="annottext">(LogEnv -&gt; Maybe LogEnv) -&gt; LogEnv -&gt; Maybe LogEnv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="Navi.Data.NaviLog.html#MkLogEnv"><span class="hs-identifier hs-type">MkLogEnv</span></a></span><span>
</span><span id="line-162"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe Handle
logHandle :: Maybe Handle
logHandle :: Maybe Handle
</span><a href="Navi.Data.NaviLog.html#logHandle"><span class="hs-identifier hs-var hs-var">logHandle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>              </span><span class="annot"><span class="annottext">LogLevel
logLevel :: LogLevel
logLevel :: LogLevel
</span><a href="Navi.Data.NaviLog.html#logLevel"><span class="hs-identifier hs-var hs-var">logLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>              </span><span class="annot"><span class="annottext">logNamespace :: Namespace
</span><a href="Navi.Data.NaviLog.html#logNamespace"><span class="hs-identifier hs-var">logNamespace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Namespace
</span><span class="hs-string">&quot;main&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>              </span><span class="annot"><span class="annottext">TBQueue LogStr
logQueue :: TBQueue LogStr
logQueue :: TBQueue LogStr
</span><a href="Navi.Data.NaviLog.html#logQueue"><span class="hs-identifier hs-var hs-var">logQueue</span></a></span><span>
</span><span id="line-166"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span id="local-6989586621679451561"><span id="local-6989586621679451562"><span class="annot"><a href="Navi.Runner.html#withLogHandle"><span class="hs-identifier hs-type">withLogHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html#MonadTime"><span class="hs-identifier hs-type">MonadTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><a href="Navi.Config.Types.html#Logging"><span class="hs-identifier hs-type">Logging</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-180"></span><span id="withLogHandle"><span class="annot"><span class="annottext">withLogHandle :: forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadTerminal m, MonadThrow m, MonadTime m) =&gt;
Logging -&gt; (Maybe Handle -&gt; m a) -&gt; m a
</span><a href="Navi.Runner.html#withLogHandle"><span class="hs-identifier hs-var hs-var">withLogHandle</span></a></span></span><span> </span><span id="local-6989586621679452090"><span class="annot"><span class="annottext">Logging
</span><a href="#local-6989586621679452090"><span class="hs-identifier hs-var">logging</span></a></span></span><span> </span><span id="local-6989586621679452091"><span class="annot"><span class="annottext">Maybe Handle -&gt; m a
</span><a href="#local-6989586621679452091"><span class="hs-identifier hs-var">onMHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LogLoc
</span><a href="#local-6989586621679452092"><span class="hs-identifier hs-var">logLoc'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- Log location defined in config file as stdout.</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">LogLoc
</span><a href="Navi.Config.Types.html#Stdout"><span class="hs-identifier hs-var">Stdout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Handle -&gt; m a
</span><a href="#local-6989586621679452091"><span class="hs-identifier hs-var">onMHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Handle
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- Custom log path.</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#File"><span class="hs-identifier hs-type">File</span></a></span><span> </span><span id="local-6989586621679452093"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452093"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="annottext">OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadThrow m) =&gt;
OsPath -&gt; m ()
</span><a href="Navi.Runner.html#renameIfExists"><span class="hs-identifier hs-var">renameIfExists</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452093"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">OsPath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a
forall a.
HasCallStack =&gt;
OsPath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a
forall (m :: Type -&gt; Type) a.
(MonadHandleWriter m, HasCallStack) =&gt;
OsPath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#withBinaryFile"><span class="hs-identifier hs-var">withBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452093"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; m a) -&gt; m a) -&gt; (Handle -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679452096"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679452096"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Handle -&gt; m a
</span><a href="#local-6989586621679452091"><span class="hs-identifier hs-var">onMHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Maybe Handle
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679452096"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- Use the default log path: xdgState &lt;/&gt; navi/log</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">LogLoc
</span><a href="Navi.Config.Types.html#DefPath"><span class="hs-identifier hs-var">DefPath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621679452097"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452097"><span class="hs-identifier hs-var">xdgState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m OsPath
forall (m :: Type -&gt; Type).
(HasCallStack, MonadPathReader m) =&gt;
OsPath -&gt; m OsPath
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#getXdgState"><span class="hs-identifier hs-var">Dir.getXdgState</span></a></span><span> </span><span class="annot"><span class="">[osp|navi|]</span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>      </span><span class="hs-comment">-- handle large log dir</span><span>
</span><span id="line-193"></span><span>      </span><span class="annot"><span class="annottext">OsPath -&gt; FilesSizeMode -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadPathReader m, MonadPathWriter m,
 MonadTerminal m) =&gt;
OsPath -&gt; FilesSizeMode -&gt; m ()
</span><a href="Navi.Runner.html#handleLogSize"><span class="hs-identifier hs-var">handleLogSize</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452097"><span class="hs-identifier hs-var">xdgState</span></a></span><span> </span><span class="annot"><span class="annottext">FilesSizeMode
</span><a href="#local-6989586621679452104"><span class="hs-identifier hs-var">sizeMode</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>      </span><span id="local-6989586621679452105"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452105"><span class="hs-identifier hs-var">currTimeOs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; m OsPath
forall (m :: Type -&gt; Type).
(HasCallStack, MonadThrow m) =&gt;
String -&gt; m OsPath
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/fs-utils-0.1-797e36c7cf412445c50285f8d3e59bbabbc28585c046e40b74676c1091471c31/share/doc/html/src/FileSystem.OsPath.html#encodeValidThrowM"><span class="hs-identifier hs-var">encodeValidThrowM</span></a></span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><span class="annottext">(String -&gt; m OsPath) -&gt; (String -&gt; String) -&gt; String -&gt; m OsPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; Type) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><a href="#local-6989586621679452106"><span class="hs-identifier hs-var">replaceSpc</span></a></span><span>
</span><span id="line-198"></span><span>          </span><span class="annot"><span class="annottext">(String -&gt; m OsPath) -&gt; m String -&gt; m OsPath
forall (m :: Type -&gt; Type) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">m String
forall (m :: Type -&gt; Type). (HasCallStack, MonadTime m) =&gt; m String
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-time-0.1-b866c4d34c8aeef4a452de10b147d031b63b7abac53567e761b021ce62d33a0e/share/doc/html/src/Effects.Time.html#getSystemTimeString"><span class="hs-identifier hs-var">Time.getSystemTimeString</span></a></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679452109"><span class="annot"><span class="annottext">logFile :: OsPath
</span><a href="#local-6989586621679452109"><span class="hs-identifier hs-var hs-var">logFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452097"><span class="hs-identifier hs-var">xdgState</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; OsPath -&gt; OsPath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452105"><span class="hs-identifier hs-var">currTimeOs</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; OsPath -&gt; OsPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="">[osp|.log|]</span></span><span>
</span><span id="line-200"></span><span>      </span><span id="local-6989586621679452111"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679452111"><span class="hs-identifier hs-var">stateExists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m Bool
forall (m :: Type -&gt; Type).
(MonadPathReader m, HasCallStack) =&gt;
OsPath -&gt; m Bool
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#doesDirectoryExist"><span class="hs-identifier hs-var">Dir.doesDirectoryExist</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452097"><span class="hs-identifier hs-var">xdgState</span></a></span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679452111"><span class="hs-identifier hs-var">stateExists</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(MonadPathWriter m, HasCallStack) =&gt;
Bool -&gt; OsPath -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">Dir.createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452097"><span class="hs-identifier hs-var">xdgState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadThrow m) =&gt;
OsPath -&gt; m ()
</span><a href="Navi.Runner.html#renameIfExists"><span class="hs-identifier hs-var">renameIfExists</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452109"><span class="hs-identifier hs-var">logFile</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><span class="annottext">OsPath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a
forall a.
HasCallStack =&gt;
OsPath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a
forall (m :: Type -&gt; Type) a.
(MonadHandleWriter m, HasCallStack) =&gt;
OsPath -&gt; IOMode -&gt; (Handle -&gt; m a) -&gt; m a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#withBinaryFile"><span class="hs-identifier hs-var">withBinaryFile</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452109"><span class="hs-identifier hs-var">logFile</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">WriteMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; m a) -&gt; m a) -&gt; (Handle -&gt; m a) -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679452115"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679452115"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Handle -&gt; m a
</span><a href="#local-6989586621679452091"><span class="hs-identifier hs-var">onMHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Maybe Handle
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679452115"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="local-6989586621679452092"><span class="annot"><span class="annottext">logLoc' :: LogLoc
</span><a href="#local-6989586621679452092"><span class="hs-identifier hs-var hs-var">logLoc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLoc -&gt; Maybe LogLoc -&gt; LogLoc
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">LogLoc
</span><a href="Navi.Config.Types.html#DefPath"><span class="hs-identifier hs-var">DefPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logging
</span><a href="#local-6989586621679452090"><span class="hs-identifier hs-var">logging</span></a></span><span> </span><span class="annot"><span class="annottext">Logging
-&gt; Optic' A_Lens NoIx Logging (Maybe LogLoc) -&gt; Maybe LogLoc
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/p6bvlvr5rdvj4y8b69w8rqyly64c6n1d-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx Logging (Maybe LogLoc)
</span><span class="">#location</span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679452104"><span class="annot"><span class="annottext">sizeMode :: FilesSizeMode
</span><a href="#local-6989586621679452104"><span class="hs-identifier hs-var hs-var">sizeMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilesSizeMode -&gt; Maybe FilesSizeMode -&gt; FilesSizeMode
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">FilesSizeMode
</span><a href="Navi.Config.Types.html#defaultSizeMode"><span class="hs-identifier hs-var">defaultSizeMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Logging
</span><a href="#local-6989586621679452090"><span class="hs-identifier hs-var">logging</span></a></span><span> </span><span class="annot"><span class="annottext">Logging
-&gt; Optic' A_Lens NoIx Logging (Maybe FilesSizeMode)
-&gt; Maybe FilesSizeMode
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/p6bvlvr5rdvj4y8b69w8rqyly64c6n1d-optics-core-0.4.1.1-doc/share/doc/optics-core-0.4.1.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx Logging (Maybe FilesSizeMode)
</span><span class="">#sizeMode</span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679452106"><span class="annot"><span class="annottext">replaceSpc :: Char -&gt; Char
</span><a href="#local-6989586621679452106"><span class="hs-identifier hs-var hs-var">replaceSpc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="#local-6989586621679452106"><span class="hs-identifier hs-var">replaceSpc</span></a></span><span> </span><span id="local-6989586621679452117"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679452117"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679452117"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621679451507"><span id="local-6989586621679451508"><span class="annot"><a href="Navi.Runner.html#writeConfigErr"><span class="hs-identifier hs-type">writeConfigErr</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileWriter.html#MonadFileWriter"><span class="hs-identifier hs-type">MonadFileWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451507"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679451507"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="#local-6989586621679451507"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451508"><span class="hs-identifier hs-type">void</span></a></span></span></span><span>
</span><span id="line-222"></span><span id="writeConfigErr"><span class="annot"><span class="annottext">writeConfigErr :: forall (m :: Type -&gt; Type) void.
(HasCallStack, MonadFileWriter m, MonadHandleWriter m,
 MonadPathReader m, MonadPathWriter m, MonadThrow m) =&gt;
SomeException -&gt; m void
</span><a href="Navi.Runner.html#writeConfigErr"><span class="hs-identifier hs-var hs-var">writeConfigErr</span></a></span></span><span> </span><span id="local-6989586621679452153"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679452153"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679452154"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452154"><span class="hs-identifier hs-var">xdgBase</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m OsPath
forall (m :: Type -&gt; Type).
(HasCallStack, MonadPathReader m) =&gt;
OsPath -&gt; m OsPath
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#getXdgState"><span class="hs-identifier hs-var">Dir.getXdgState</span></a></span><span> </span><span class="annot"><span class="">[osp|navi|]</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679452155"><span class="annot"><span class="annottext">logFile :: OsPath
</span><a href="#local-6989586621679452155"><span class="hs-identifier hs-var hs-var">logFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452154"><span class="hs-identifier hs-var">xdgBase</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; OsPath -&gt; OsPath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="">[osp|config_fatal.log|]</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadThrow m) =&gt;
OsPath -&gt; m ()
</span><a href="Navi.Runner.html#renameIfExists"><span class="hs-identifier hs-var">renameIfExists</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452155"><span class="hs-identifier hs-var">logFile</span></a></span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="annottext">OsPath -&gt; Text -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadFileWriter m) =&gt;
OsPath -&gt; Text -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.FileWriter.html#writeFileUtf8"><span class="hs-identifier hs-var">writeFileUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452155"><span class="hs-identifier hs-var">logFile</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Couldn't read config: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Text
forall e. Exception e =&gt; e -&gt; Text
</span><a href="Navi.Prelude.html#displayExceptiont"><span class="hs-identifier hs-var">displayExceptiont</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679452153"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">SomeException -&gt; m void
forall e a. (HasCallStack, Exception e) =&gt; e -&gt; m a
forall (m :: Type -&gt; Type) e a.
(MonadThrow m, HasCallStack, Exception e) =&gt;
e -&gt; m a
</span><span class="hs-identifier hs-var">throwM</span></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621679452153"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621679451575"><span class="annot"><a href="Navi.Runner.html#renameIfExists"><span class="hs-identifier hs-type">renameIfExists</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451575"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679451575"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="#local-6989586621679451575"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-238"></span><span id="renameIfExists"><span class="annot"><span class="annottext">renameIfExists :: forall (m :: Type -&gt; Type).
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadPathWriter m, MonadThrow m) =&gt;
OsPath -&gt; m ()
</span><a href="Navi.Runner.html#renameIfExists"><span class="hs-identifier hs-var hs-var">renameIfExists</span></a></span></span><span> </span><span id="local-6989586621679452180"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452180"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679452181"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679452181"><span class="hs-identifier hs-var">fileExists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m Bool
forall (m :: Type -&gt; Type).
(MonadPathReader m, HasCallStack) =&gt;
OsPath -&gt; m Bool
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#doesFileExist"><span class="hs-identifier hs-var">Dir.doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452180"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679452181"><span class="hs-identifier hs-var">fileExists</span></a></span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679452184"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452184"><span class="hs-identifier hs-var">fp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m OsPath
forall (m :: Type -&gt; Type).
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadThrow m) =&gt;
OsPath -&gt; m OsPath
</span><a href="Navi.Runner.html#uniqName"><span class="hs-identifier hs-var">uniqName</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452180"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="annot"><span class="annottext">OsPath -&gt; OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(MonadPathWriter m, HasCallStack) =&gt;
OsPath -&gt; OsPath -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#renameFile"><span class="hs-identifier hs-var">Dir.renameFile</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452180"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452184"><span class="hs-identifier hs-var">fp'</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Navi.Runner.html#uniqName"><span class="hs-identifier hs-type">uniqName</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679451608"><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#MonadHandleWriter"><span class="hs-identifier hs-type">MonadHandleWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span>
</span><span id="line-253"></span><span id="uniqName"><span class="annot"><span class="annottext">uniqName :: forall (m :: Type -&gt; Type).
(HasCallStack, MonadHandleWriter m, MonadPathReader m,
 MonadThrow m) =&gt;
OsPath -&gt; m OsPath
</span><a href="Navi.Runner.html#uniqName"><span class="hs-identifier hs-var hs-var">uniqName</span></a></span></span><span> </span><span id="local-6989586621679452226"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452226"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; m OsPath
</span><a href="#local-6989586621679452227"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621679452227"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679452227"><span class="annot"><span class="annottext">go :: Word16 -&gt; m OsPath
</span><a href="#local-6989586621679452227"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679452228"><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679452228"><span class="hs-identifier hs-var">counter</span></a></span></span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679452228"><span class="hs-identifier hs-var">counter</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Word16
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; m OsPath
forall (m :: Type -&gt; Type) a.
(HasCallStack, MonadHandleWriter m, MonadThrow m) =&gt;
String -&gt; m a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.HandleWriter.html#die"><span class="hs-identifier hs-var">die</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m OsPath) -&gt; String -&gt; m OsPath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failed renaming file: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452226"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>          </span><span id="local-6989586621679452231"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452231"><span class="hs-identifier hs-var">fp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452226"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; OsPath -&gt; OsPath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(OsPath -&gt; OsPath) -&gt; m OsPath -&gt; m OsPath
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; m OsPath
forall (m :: Type -&gt; Type).
(HasCallStack, MonadThrow m) =&gt;
String -&gt; m OsPath
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/fs-utils-0.1-797e36c7cf412445c50285f8d3e59bbabbc28585c046e40b74676c1091471c31/share/doc/html/src/FileSystem.OsPath.html#encodeThrowM"><span class="hs-identifier hs-var">encodeThrowM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679452228"><span class="hs-identifier hs-var">counter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>          </span><span id="local-6989586621679452232"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679452232"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m Bool
forall (m :: Type -&gt; Type).
(MonadPathReader m, HasCallStack) =&gt;
OsPath -&gt; m Bool
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#doesFileExist"><span class="hs-identifier hs-var">Dir.doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452231"><span class="hs-identifier hs-var">fp'</span></a></span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679452232"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-262"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; m OsPath
</span><a href="#local-6989586621679452227"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word16
</span><a href="#local-6989586621679452228"><span class="hs-identifier hs-var">counter</span></a></span><span> </span><span class="annot"><span class="annottext">Word16 -&gt; Word16 -&gt; Word16
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Word16
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m OsPath
forall a. a -&gt; m a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452231"><span class="hs-identifier hs-var">fp'</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span id="local-6989586621679451587"><span class="annot"><a href="Navi.Runner.html#handleLogSize"><span class="hs-identifier hs-type">handleLogSize</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#MonadPathReader"><span class="hs-identifier hs-type">MonadPathReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451587"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#MonadPathWriter"><span class="hs-identifier hs-type">MonadPathWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451587"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451587"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">OsPath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Navi.Config.Types.html#FilesSizeMode"><span class="hs-identifier hs-type">FilesSizeMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><a href="#local-6989586621679451587"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-274"></span><span id="handleLogSize"><span class="annot"><span class="annottext">handleLogSize :: forall (m :: Type -&gt; Type).
(HasCallStack, MonadPathReader m, MonadPathWriter m,
 MonadTerminal m) =&gt;
OsPath -&gt; FilesSizeMode -&gt; m ()
</span><a href="Navi.Runner.html#handleLogSize"><span class="hs-identifier hs-var hs-var">handleLogSize</span></a></span></span><span> </span><span id="local-6989586621679452289"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span></span><span> </span><span id="local-6989586621679452290"><span class="annot"><span class="annottext">FilesSizeMode
</span><a href="#local-6989586621679452290"><span class="hs-identifier hs-var">sizeMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-comment">-- NOTE: Only files should be logs</span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621679452291"><span class="annot"><span class="annottext">[OsPath]
</span><a href="#local-6989586621679452291"><span class="hs-identifier hs-var">logFiles</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; m [OsPath]
forall (m :: Type -&gt; Type).
(MonadPathReader m, HasCallStack) =&gt;
OsPath -&gt; m [OsPath]
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#listDirectory"><span class="hs-identifier hs-var">Dir.listDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span id="local-6989586621679452293"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679452293"><span class="hs-identifier hs-var">totalBytes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><span class="annottext">(m Integer -&gt; OsPath -&gt; m Integer)
-&gt; m Integer -&gt; [OsPath] -&gt; m Integer
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: Type -&gt; Type) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span>
</span><span id="line-279"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679452295"><span class="annot"><span class="annottext">m Integer
</span><a href="#local-6989586621679452295"><span class="hs-identifier hs-var">macc</span></a></span></span><span> </span><span id="local-6989586621679452296"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452296"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer)
-&gt; m Integer -&gt; m Integer -&gt; m Integer
forall a b c. (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c
forall (f :: Type -&gt; Type) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">m Integer
</span><a href="#local-6989586621679452295"><span class="hs-identifier hs-var">macc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OsPath -&gt; m Integer
forall (m :: Type -&gt; Type).
(MonadPathReader m, HasCallStack) =&gt;
OsPath -&gt; m Integer
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathReader.html#getFileSize"><span class="hs-identifier hs-var">Dir.getFileSize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath -&gt; OsPath -&gt; OsPath
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452296"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; m Integer
forall a. a -&gt; m a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><span class="annottext">[OsPath]
</span><a href="#local-6989586621679452291"><span class="hs-identifier hs-var">logFiles</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679452299"><span class="annot"><span class="annottext">totalBytes' :: Bytes 'B Natural
</span><a href="#local-6989586621679452299"><span class="hs-identifier hs-var hs-var">totalBytes'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (s :: Size) n. n -&gt; Bytes s n
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Internal.html#MkBytes"><span class="hs-identifier hs-var">MkBytes</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Size.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Natural
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679452293"><span class="hs-identifier hs-var">totalBytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FilesSizeMode
</span><a href="#local-6989586621679452290"><span class="hs-identifier hs-var">sizeMode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-285"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#FilesSizeModeWarn"><span class="hs-identifier hs-type">FilesSizeModeWarn</span></a></span><span> </span><span id="local-6989586621679452301"><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452301"><span class="hs-identifier hs-var">warnSize</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452299"><span class="hs-identifier hs-var">totalBytes'</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural -&gt; Bytes 'B Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452301"><span class="hs-identifier hs-var">warnSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadTerminal m) =&gt;
Text -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#putTextLn"><span class="hs-identifier hs-var">putTextLn</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural -&gt; OsPath -&gt; Bytes 'B Natural -&gt; Text
</span><a href="#local-6989586621679452304"><span class="hs-identifier hs-var">sizeWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452301"><span class="hs-identifier hs-var">warnSize</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452299"><span class="hs-identifier hs-var">totalBytes'</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="Navi.Config.Types.html#FilesSizeModeDelete"><span class="hs-identifier hs-type">FilesSizeModeDelete</span></a></span><span> </span><span id="local-6989586621679452305"><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452305"><span class="hs-identifier hs-var">delSize</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452299"><span class="hs-identifier hs-var">totalBytes'</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural -&gt; Bytes 'B Natural -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452305"><span class="hs-identifier hs-var">delSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; m ()
forall (m :: Type -&gt; Type).
(HasCallStack, MonadTerminal m) =&gt;
Text -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-terminal-0.1-5e9320c252a0a4f19fc23b01106505f5ee3c09507f1c769f2d400dfcdae28ef8/share/doc/html/src/Effects.System.Terminal.html#putTextLn"><span class="hs-identifier hs-var">putTextLn</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; m ()) -&gt; Text -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural -&gt; OsPath -&gt; Bytes 'B Natural -&gt; Text
</span><a href="#local-6989586621679452304"><span class="hs-identifier hs-var">sizeWarning</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452305"><span class="hs-identifier hs-var">delSize</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452299"><span class="hs-identifier hs-var">totalBytes'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; Deleting logs.&quot;</span></span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(MonadPathWriter m, HasCallStack) =&gt;
OsPath -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#removeDirectoryRecursive"><span class="hs-identifier hs-var">Dir.removeDirectoryRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; OsPath -&gt; m ()
forall (m :: Type -&gt; Type).
(MonadPathWriter m, HasCallStack) =&gt;
Bool -&gt; OsPath -&gt; m ()
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/effects-fs-0.1-939bb2cbf42411240e371281dbd18acb7c2362452fb536058a1de1cb3f641bb3/share/doc/html/src/Effects.FileSystem.PathWriter.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">Dir.createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452289"><span class="hs-identifier hs-var">naviState</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621679452304"><span class="annot"><span class="annottext">sizeWarning :: Bytes 'B Natural -&gt; OsPath -&gt; Bytes 'B Natural -&gt; Text
</span><a href="#local-6989586621679452304"><span class="hs-identifier hs-var hs-var">sizeWarning</span></a></span></span><span> </span><span id="local-6989586621679452307"><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452307"><span class="hs-identifier hs-var">warnSize</span></a></span></span><span> </span><span id="local-6989586621679452308"><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452308"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span id="local-6989586621679452309"><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452309"><span class="hs-identifier hs-var">fileSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Warning: log dir '&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>          </span><span class="annot"><span class="annottext">OsPath -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Navi.Prelude.html#showt"><span class="hs-identifier hs-var">showt</span></a></span><span> </span><span class="annot"><span class="annottext">OsPath
</span><a href="#local-6989586621679452308"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;' has size: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>          </span><span class="annot"><span class="annottext">Bytes 'B Natural -&gt; Text
</span><a href="#local-6989586621679452311"><span class="hs-identifier hs-var">formatBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452309"><span class="hs-identifier hs-var">fileSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-301"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;, but specified threshold is: &quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>          </span><span class="annot"><span class="annottext">Bytes 'B Natural -&gt; Text
</span><a href="#local-6989586621679452311"><span class="hs-identifier hs-var">formatBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Natural
</span><a href="#local-6989586621679452307"><span class="hs-identifier hs-var">warnSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-303"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679452311"><span class="annot"><span class="annottext">formatBytes :: Bytes 'B Natural -&gt; Text
</span><a href="#local-6989586621679452311"><span class="hs-identifier hs-var hs-var">formatBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><span class="annottext">BaseFormatter (Raw (Norm (Bytes 'B Double)))
-&gt; SizedFormatter -&gt; Norm (Bytes 'B Double) -&gt; Text
forall a.
(Formatter (BaseFormatter (Raw a)), PrintfArg (Raw a),
 RawNumeric a, Sized a) =&gt;
BaseFormatter (Raw a) -&gt; SizedFormatter -&gt; a -&gt; Text
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Formatting.html#formatSized"><span class="hs-identifier hs-var">Bytes.formatSized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Word8 -&gt; FloatingFormatter
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Formatting.Base.html#MkFloatingFormatter"><span class="hs-identifier hs-var">MkFloatingFormatter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Maybe Word8
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SizedFormatter
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Formatting.Size.html#sizedFormatterNatural"><span class="hs-identifier hs-var">Bytes.sizedFormatterNatural</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><span class="annottext">(Norm (Bytes 'B Double) -&gt; Text)
-&gt; (Bytes 'B Natural -&gt; Norm (Bytes 'B Double))
-&gt; Bytes 'B Natural
-&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; Type) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bytes 'B Double -&gt; Norm (Bytes 'B Double)
forall a. Normalize a =&gt; a -&gt; Norm a
</span><a href="file:///home/tommy/.local/state/cabal/store/ghc-9.10.2-b583/si-bytes-0.1-b16f6c6eb3b198a1e493ba8c5f716b3b5c8851274b5b998bd6c91c4764581f58/share/doc/html/src/Data.Bytes.Class.Normalize.html#normalize"><span class="hs-identifier hs-var">Bytes.normalize</span></a></span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-comment">-- Convert to double _before_ normalizing. We may lose some precision</span><span>
</span><span id="line-310"></span><span>        </span><span class="hs-comment">-- here, but it is better than normalizing a natural, which will</span><span>
</span><span id="line-311"></span><span>        </span><span class="hs-comment">-- truncate (i.e. greater precision loss).</span><span>
</span><span id="line-312"></span><span>        </span><span class="annot"><span class="annottext">(Bytes 'B Double -&gt; Norm (Bytes 'B Double))
-&gt; (Bytes 'B Natural -&gt; Bytes 'B Double)
-&gt; Bytes 'B Natural
-&gt; Norm (Bytes 'B Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
forall {k} (cat :: k -&gt; k -&gt; Type) (b :: k) (c :: k) (a :: k).
Category cat =&gt;
cat b c -&gt; cat a b -&gt; cat a c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Double) -&gt; Bytes 'B Natural -&gt; Bytes 'B Double
forall a b. (a -&gt; b) -&gt; Bytes 'B a -&gt; Bytes 'B b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Natural</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span></pre></body></html>